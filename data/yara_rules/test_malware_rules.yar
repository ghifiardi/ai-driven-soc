/*
Test YARA Rules for Threat Hunting
These are sample rules for testing THOR detection capabilities.
*/

rule Test_Ransomware_Signature {
    meta:
        description = "Test ransomware detection rule"
        author = "SOC Team"
        severity = "high"
        date = "2026-01-05"
    strings:
        $s1 = "encrypt" ascii nocase
        $s2 = "ransom" ascii nocase
        $s3 = "decrypt" ascii nocase
        $s4 = { 52 61 6E 73 6F 6D } // "Ransom" in hex
    condition:
        2 of them
}

rule Test_Backdoor_Detection {
    meta:
        description = "Test backdoor detection rule"
        author = "SOC Team"
        severity = "high"
        date = "2026-01-05"
    strings:
        $s1 = "cmd.exe" ascii nocase
        $s2 = "/c" ascii
        $s3 = "powershell" ascii nocase
        $s4 = "-encodedcommand" ascii nocase
        $s5 = "backdoor" ascii nocase
    condition:
        3 of them
}

rule Test_Webshell_Detection {
    meta:
        description = "Test webshell detection rule"
        author = "SOC Team"
        severity = "high"
        date = "2026-01-05"
    strings:
        $s1 = "eval(" ascii
        $s2 = "base64_decode" ascii
        $s3 = "system(" ascii
        $s4 = "exec(" ascii
        $s5 = "shell_exec" ascii
    condition:
        2 of them
}

rule Test_CryptoMiner_Detection {
    meta:
        description = "Test cryptocurrency miner detection"
        author = "SOC Team"
        severity = "medium"
        date = "2026-01-05"
    strings:
        $s1 = "mining" ascii nocase
        $s2 = "cryptocurrency" ascii nocase
        $s3 = "bitcoin" ascii nocase
        $s4 = "mining_pool" ascii nocase
        $s5 = "stratum" ascii nocase
    condition:
        2 of them
}

rule Test_Suspicious_Process {
    meta:
        description = "Test suspicious process detection"
        author = "SOC Team"
        severity = "medium"
        date = "2026-01-05"
    strings:
        $s1 = "suspicious_process" ascii
        $s2 = "malware_signature" ascii
        $s3 = "test_threat" ascii
    condition:
        any of them
}

rule Test_File_Hash_Match {
    meta:
        description = "Test file hash matching"
        author = "SOC Team"
        severity = "high"
        date = "2026-01-05"
    strings:
        $s1 = "test_malware_hash" ascii
        $s2 = "known_bad_hash" ascii
    condition:
        any of them
}

